(this.webpackJsonpmidft=this.webpackJsonpmidft||[]).push([[0],{341:function(e,t){},359:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(68),s=a.n(c),i=a(6),o=a(18),l=a(10),u=a(9),h=a(445),b=a(439),f=a(446),j=a(441),d=a(442),x=a(447),p=a(88),g=a(11),O=a(113),m=a.n(O),v=a(440),y=a(1),w=Object(g.a)(h.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,a=e.open;return Object(u.a)({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},a&&{width:"calc(100% - ".concat(400,"px)"),marginLeft:"".concat(400,"px"),transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})}));function k(e){var t=e.open,a=e.setOpen,n=e.inAnalysisPage;return Object(y.jsx)(b.a,{sx:{flexGrow:1},children:Object(y.jsx)(w,{position:"static",open:t,children:Object(y.jsxs)(f.a,{children:[Object(y.jsx)(v.a,{disabled:!n,color:"inherit","aria-label":"open drawer",onClick:function(){a(!0)},edge:"start",sx:Object(u.a)({mr:2},t&&{display:"none"}),children:Object(y.jsx)(m.a,{})}),Object(y.jsx)(j.a,{variant:"h3",component:"div",sx:{flexGrow:1},children:"Mi_DFT"}),Object(y.jsxs)(x.a,{"aria-label":"outlined button group",children:[Object(y.jsx)(d.a,{component:p.b,to:"/",variant:"contained",disableElevation:!0,children:"Home"}),Object(y.jsx)(d.a,{component:p.b,to:"/theory",variant:"contained",disableElevation:!0,children:"Theory"}),Object(y.jsx)(d.a,{component:p.b,to:"/analysis",variant:"contained",disableElevation:!0,children:"Analysis"})]})]})})})}var C=a(26),D=a(169),A=a.n(D),S=a(421),P=a(170),F=a.n(P),E=a(35),W=a(423),M=E.c().domain([0,1]).range(E.b(0,255,1)),I=function(e){var t,a,n;return e>=0&&e<W.f/3?(t=1,a=3*e/W.f,n=0):e>=W.f/3&&e<2*W.f/3?(t=2-3*e/W.f,a=1,n=0):e>=2*W.f/3&&e<W.f?(t=0,a=1,n=3*e/W.f-2):e>=W.f&&e<4*W.f/3?(t=0,a=4-3*e/W.f,n=1):e>=4*W.f/3&&e<5*W.f/3?(t=3*e/W.f-4,a=0,n=1):e>=5*W.f/3&&e<2*W.f&&(t=1,a=0,n=6-3*e/W.f),t=M(t),a=M(a),n=M(n),"rgb(".concat(t,", ").concat(a,", ").concat(n,")")},T=function(e,t,a){var n,r,c,s=Math.atan2(t,e);return(s=-s)<0&&(s+=2*Math.PI),s>=0&&s<W.f/3?(n=1,r=3*s/W.f,c=0):s>=W.f/3&&s<2*W.f/3?(n=2-3*s/W.f,r=1,c=0):s>=2*W.f/3&&s<W.f?(n=0,r=1,c=3*s/W.f-2):s>=W.f&&s<4*W.f/3?(n=0,r=4-3*s/W.f,c=1):s>=4*W.f/3&&s<5*W.f/3?(n=3*s/W.f-4,r=0,c=1):s>=5*W.f/3&&s<2*W.f&&(n=1,r=0,c=6-3*s/W.f),{r:n=M(n),g:r=M(r),b:c=M(c),a:M(a)}};function R(e){var t=e.toPolar(),a=t.phi,n=t.r;a<0&&(a+=2*W.f);var r=I(a).slice(3,-1);return"rgba".concat(r,", ").concat(n,")")}var z,B,N=function(e){var t=e.printablePitchClasses,a=e.traceData,n=e.userPcv,r=e.currentSubdiv,c=e.coeffNumber,s=300,i=270,o=[];if(a.length>0)for(var l=a[0],u=1;u<l[0].length;u++){for(var h=[],b=0;b<l.length;b++){var f=Math.round(1e4*l[b][u].re)/1e4,j=Math.round(1e4*l[b][u].im)/1e4;h.push({re:f,im:j})}o.push(h)}var d=2*W.f/100,x=E.b(0,2*W.f,d),p=E.b(0,1,.01),g=function(e,t,a){var n=E.a().innerRadius(t*s/2).outerRadius((t+.01)*s/2).startAngle(0).endAngle(2*W.f);return Object(y.jsx)("path",{transform:"translate(".concat(e.x*i/2,",").concat(-e.y*i/2,")"),fill:a,d:n()},e.id)};return Object(y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:300,children:[Object(y.jsx)("g",{transform:"translate(".concat(150,",").concat(150,")"),children:p.map((function(e){return x.map((function(t,a){return function(e,t,a,n){var r=-W.f/2,c=E.a().innerRadius(n*i/2).outerRadius((n+.01)*i/2).startAngle(-(e+r)).endAngle(-(e+d+r));return Object(y.jsx)("path",{fill:I(e),fillOpacity:n,stroke:I(e),strokeOpacity:n/10,d:c()},"".concat(a,".").concat(t))}(t,a,c,e)}))}))}),Object(y.jsx)("g",{transform:"translate(".concat(150,",").concat(150,")"),children:t.map((function(e){return e.coeff.includes(c+1)?g(e,.05,"grey"):null}))}),Object(y.jsx)("g",{transform:"translate(".concat(150,",").concat(150,")"),children:n.map((function(e,t){return e.map((function(e,a){return a>0&&c+1===a?g({x:e.re,y:e.im,id:"userpcv".concat(c,".").concat(t,".").concat(a)},.03,"navy"):null}))}))}),Object(y.jsx)("g",{transform:"translate(".concat(150,",").concat(150,")"),children:o.length>1?o[c].map((function(e,t){return function(e,t,a){var n=E.a().innerRadius(0).outerRadius(3).startAngle(0).endAngle(2*W.f);return Object(y.jsx)("path",{transform:"translate(".concat(e.re*i/2,",").concat(-e.im*i/2,")"),fill:"black",d:n()},"trace".concat(t,".").concat(a))}(e,c,t)})):null}),Object(y.jsx)("g",{transform:"translate(".concat(150,",").concat(150,")"),children:o.length>1?function(e){return Object(y.jsx)("path",{transform:"translate(".concat(o[e][r].re*i/2,",").concat(-o[e][r].im*i/2,")"),fill:"white",d:E.a().innerRadius(4.5).outerRadius(9).startAngle(0).endAngle(2*W.f)()},"currentSubdiv".concat(r))}(c):null})]},"circle".concat(c))},G=a(171),L=a(33),_=a(416),V=a(176),H=a.n(V),q=a(175),U=a.n(q),J=a(174),K=a.n(J),Q=a(429),X=0,Y=Object(g.a)(j.a)({fontSize:"0.75rem",opacity:.38,fontWeight:500,letterSpacing:.2});function Z(e){var t=Math.floor(e/60),a=Math.floor(e-60*t);return"".concat(t,":").concat(a<9?"0".concat(a):a)}function $(e,t,a){L.d.cancel(0),a(0),L.d.stop(),X=e.duration;var n=[];e.tracks.forEach((function(e){return e.notes.forEach((function(e){n.push(e)}))})),n.forEach((function(e){e.subdiv=Math.floor(e.time/t)})),(z=new L.b((function(e,t){ee.triggerAttackRelease(t.name,t.duration,e,t.velocity),a(t.subdiv)}),[].concat(n)).start(0)).loop=!0,z.loopEnd=X}var ee=new L.c({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/"}).toDestination();function te(e){var t=e.fileName,a=(e.currentWavescapeSubdiv,Object(n.useState)(0)),r=Object(l.a)(a,2),c=r[0],s=r[1];return Object(y.jsxs)(b.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"60%"},children:[Object(y.jsxs)(b.a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[Object(y.jsxs)(_.a,{direction:"row",sx:{flexGrow:1,paddingLeft:"10%"},children:[Object(y.jsx)(v.a,{sx:{padding:"0"},onClick:function(){console.log("stop"),L.d.stop(),ae()},size:"large",children:Object(y.jsx)(K.a,{fontSize:"large"})}),Object(y.jsx)(v.a,{sx:{padding:"0"},onClick:function(){console.log("pause"),L.d.pause(),ae()},size:"large",children:Object(y.jsx)(U.a,{fontSize:"large"})}),Object(y.jsx)(v.a,{sx:{padding:"0"},onClick:function(){console.log("play"),"running"!==L.e.state&&(console.log("state running"),L.e.resume()),L.d.start(),!B&&z&&(B=setInterval((function(){return s(z.progress)}),1e3))},size:"large",children:Object(y.jsx)(H.a,{fontSize:"large"})})]}),Object(y.jsx)(j.a,{color:t?"primary":"error",noWrap:!0,sx:{flexGrow:"2",paddingRight:"10%"},children:t||"No midi file uploaded"})]}),Object(y.jsx)(Q.a,{"aria-label":"Playback",size:"small",value:c?100*c:0,onChange:function(e,t){s(t/100),L.d.seconds=t/100*X},sx:{width:"90%"}}),Object(y.jsxs)(b.a,{sx:{display:"flex",width:"90%",alignItems:"center",justifyContent:"space-between",mt:-1},children:[Object(y.jsxs)(Y,{children:["-",Z(X-c*X)]}),Object(y.jsx)(Y,{children:Z(X)})]})]})}function ae(){clearInterval(B),B=null}ee.volume.value=-20;var ne=a(2),re=a(3),ce=a(119);function se(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.length,c=[],s=0;s<r/2+1;s++){for(var i=0,o=0;o<r;o++)i=W.a(W.e(e[o],W.c(W.e(W.d,-2*W.f*s*o/r))),i);c.push(i)}if(c=c.slice(),t){var l=c[0];0!=l&&(c=c.map((function(e){return W.b(e,l)})))}return a&&c.forEach((function(e){e.re=Math.round(1e4*e.re)/1e4,e.im=Math.round(1e4*e.im)/1e4})),n&&(c=c.map((function(e){return e.toPolar()}))),c}function ie(e){for(var t=e[0],a=1;a<e.length;a++){for(var n=[],r=0;r<e[a].length;r++)n.push(W.a(t[r],e[a][r]));t=n.slice()}var c=t[0];return t=t.map((function(e){return W.b(e,c)}))}var oe=function(){function e(){Object(ne.a)(this,e),this.C=0,this.Cs=0,this.D=0,this.Ds=0,this.E=0,this.F=0,this.Fs=0,this.G=0,this.Gs=0,this.A=0,this.As=0,this.B=0}return Object(re.a)(e,[{key:"addNoteDuration",value:function(e,t){switch(e){case"C":this.C+=t;break;case"C#":this.Cs+=t;break;case"D":this.D+=t;break;case"D#":this.Ds+=t;break;case"E":this.E+=t;break;case"F":this.F+=t;break;case"F#":this.Fs+=t;break;case"G":this.G+=t;break;case"G#":this.Gs+=t;break;case"A":this.A+=t;break;case"A#":this.As+=t;break;case"B":this.B+=t}}},{key:"getPcvAsArray",value:function(){return[this.C,this.Cs,this.D,this.Ds,this.E,this.F,this.Fs,this.G,this.Gs,this.A,this.As,this.B]}},{key:"add",value:function(e){this.C=e.C,this.Cs=e.Cs,this.D=e.D,this.Ds=e.Ds,this.E=e.E,this.F=e.F,this.Fs=e.Fs,this.G=e.G,this.Gs=e.Gs,this.A=e.A,this.As=e.As,this.B=e.B}}]),e}();function le(e,t,a){var n,r=t.noteResolutionValue,c=t.seconds,s=t.useSeconds;n=s?isNaN(c)?1:c:r*(60/a);var i=e.duration,o=[];e.tracks.filter((function(e){return!1===e.instrument.percussion})).forEach((function(e){o.push(ue(e.notes,n,i))}));for(var l=[],u=0;u<o[0].length;u++)l.push(new oe);for(var h=0;h<o.length;h++)for(var b=0;b<o[h].length;b++)for(var f=0;f<o[h][b].length;f++){var j=o[h][b][f],d=j.pitch,x=j.duration;l[b].addNoteDuration(d,x)}var p=l.map((function(e){return se(e.getPcvAsArray())})),g=[];g.push(p);for(var O=[],m=g[0],v=1;v<7;v++){for(var y=[],w=0;w<m.length;w++)y.push({x:m[w][v].re,y:m[w][v].im});O.push(y)}return{tracesData:O,resolution:n}}function ue(e,t,a){for(var n=[],r=t,c=function(t){var a=[];e.forEach((function(e){var n=e.time,c=e.duration;if(function(e,t,a,n){if(e>a&&e<a+n||e+t>a&&e+t<a+n||e<=a&&e+t>=a+n)return!0;return!1}(n,c,t,r)){var s={pitch:e.pitch};s.duration=n<t?n+c<t+r?n+c-t:r:n+c<=t+r?c:t+r-n,a.push(s)}})),n.push(a)},s=0;s<a;s+=t)c(s);return n}function he(e,t){for(var a=[],n=0;n<2*Math.PI*t;n+=.01){var r=10*Math.cos(e/t*n),c=r*Math.cos(n),s=r*Math.sin(n);a.push([c,s])}return a}var be=a(428),fe=a(417),je=a(448),de=a(443),xe=a(431),pe=a.p+"static/media/whole.69e31bd8.svg",ge=a.p+"static/media/half.7d756528.svg",Oe=a.p+"static/media/quarter.a35808dc.svg",me=a.p+"static/media/eighth.347a1769.svg",ve=a.p+"static/media/sixteenth.91907e68.svg";var ye=function(e){var t=e.resolutionMode,a=e.setResolutionMode,r=e.retriggerAnalysis,c=Object(n.useState)(!1),s=Object(l.a)(c,2),i=s[0],o=s[1],h=Object(n.useRef)(null);return Object(y.jsx)(b.a,{children:Object(y.jsx)(je.a,{component:"fieldset",children:Object(y.jsxs)(fe.a,{row:!0,defaultValue:"quarter",onChange:function(e){var n=Object(u.a)({},t);switch(n.seconds=parseFloat(h.current.value),e.target.value){case"sixteenth":n.noteResolutionValue=.25,n.useSeconds=!1;break;case"eighth":n.noteResolutionValue=.5,n.useSeconds=!1;break;case"quarter":n.noteResolutionValue=1,n.useSeconds=!1;break;case"half":n.noteResolutionValue=2,n.useSeconds=!1;break;case"whole":n.noteResolutionValue=4,n.useSeconds=!1;break;case"seconds":n.useSeconds=!0}a(n)},"aria-label":"resolution",name:"row-radio-buttons-group",sx:{display:"flex",justifyContent:"space-between"},children:[Object(y.jsx)(de.a,{value:"sixteenth",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)("img",{style:{width:10,height:10,transform:"scale(3, 3)"},src:ve})}),Object(y.jsx)(de.a,{value:"eighth",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)("img",{style:{width:10,height:10,transform:"scale(3, 3) translate(0, 0)"},src:me})}),Object(y.jsx)(de.a,{value:"quarter",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)("img",{style:{width:10,height:10,marginTop:8,transform:"scale(1, 3)"},src:Oe})}),Object(y.jsx)(de.a,{value:"half",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)("img",{style:{width:10,height:10,marginTop:8,transform:"scale(3.7, 3.2) "},src:ge})}),Object(y.jsx)(de.a,{value:"whole",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)("img",{style:{width:10,height:10,marginTop:0,transform:"scale(1.5, 1)"},src:pe})}),Object(y.jsx)(de.a,{value:"seconds",control:Object(y.jsx)(be.a,{size:"small"}),label:Object(y.jsx)(xe.a,{sx:{minHeight:"4.4rem",maxWidth:"5rem"},error:i,helperText:i&&"Invalid input",label:"in seconds",id:"standard-size-small",defaultValue:"1.5",size:"small",variant:"standard",onChange:function(){var e=Object(u.a)({},t);e.seconds=parseFloat(h.current.value),isNaN(e.seconds)?o(!0):(a(e),o(!1))},inputRef:h})}),Object(y.jsx)(d.a,{variant:"contained",onClick:r,sx:{width:"22%",height:"15%",marginTop:2},children:"Change"})]})})})},we=a(436),ke=a(438),Ce=Object(g.a)("li")((function(e){return{margin:e.theme.spacing(.5)}}));function De(e){var t=e.userPcvs,a=e.setUserPcvs,n=e.rosesMat;return Object(y.jsx)(ke.a,{sx:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",p:"3px",overflow:"auto",height:"100%",width:"100%"},component:"ul",children:t.map((function(e,r){return Object(y.jsx)(Ce,{children:Object(y.jsx)(we.a,{variant:e.isDisabled?"outlined":"filled",icon:Object(y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(y.jsx)("g",{children:Object(y.jsx)("polyline",{transform:"translate(".concat(12,",",12,")"),fill:"none",stroke:"black",strokeWidth:"1px",points:e.rosePoints})})}),label:e.label,onDelete:(c=e,function(){n[c.d-1][c.n-1].used=!1,a((function(e){return e.filter((function(e){return e.label!==c.label}))}))}),onClick:function(){e.isDisabled=!e.isDisabled,a(Object(o.a)(t))}})},"".concat(r));var c}))})}var Ae=a(54),Se=a(177),Pe=a(453),Fe=["to"];var Ee={overrides:{h1:{component:j.a,props:{gutterBottom:!0,variant:"h4",component:"h1"}},h2:{component:j.a,props:{gutterBottom:!0,variant:"h6",component:"h2"}},h3:{component:j.a,props:{gutterBottom:!0,variant:"subtitle1"}},h4:{component:j.a,props:{gutterBottom:!0,variant:"caption",paragraph:!0}},p:{component:j.a,props:{paragraph:!0}},a:{component:function(e){e.to;var t=Object(Ae.a)(e,Fe),a=n.useRef(null);return isNaN(parseInt(t.href[1]))?Object(y.jsx)(Pe.a,Object(u.a)({},t)):Object(y.jsx)(Pe.a,Object(u.a)(Object(u.a)({ref:a,onClick:function(e){e.preventDefault(),a.current.scrollIntoView({behavior:"smooth"})}},t),{},{id:"reference".concat(t.href[1]),href:"/#".concat(t.href[1])}))}},li:{component:function(e){return Object(y.jsx)(b.a,Object(u.a)({component:"li",sx:{mt:1,typography:"body1"}},e))}}}};function We(e){return Object(y.jsx)(Se.a,Object(u.a)({options:Ee},e))}var Me=a.p+"static/media/HomeMarkdown.4682608b.md";function Ie(e){var t=e.setOpen,a=e.setInAnalysisPage,r=Object(n.useState)(""),c=Object(l.a)(r,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){a(!1),t(!1),fetch(Me).then((function(e){return e.text()})).then((function(e){i(e)}))}),[]),Object(y.jsx)(ke.a,{sx:{margin:"auto",maxWidth:"1200px"},children:Object(y.jsx)(b.a,{sx:{padding:3},children:Object(y.jsx)(We,{children:s})})})}var Te=a.p+"static/media/TheoryMarkdown.26c0a4ee.md";function Re(e){var t=e.setOpen,a=e.setInAnalysisPage,r=Object(n.useState)(""),c=Object(l.a)(r,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){a(!1),t(!1),fetch(Te).then((function(e){return e.text()})).then((function(e){i(e)}))}),[]),Object(y.jsx)(ke.a,{sx:{margin:"auto",maxWidth:"1200px"},children:Object(y.jsx)(b.a,{sx:{padding:3},children:Object(y.jsx)(We,{children:s})})})}var ze=Math.sin(Math.PI/3),Be=function(e){var t,a=e.wsNumber,r=e.wavescapeMatrix,c=e.currentWavescapeSubdiv,s=e.wavescapeWidth,i=Object(n.useRef)(null),o=Object(n.useState)([]),u=Object(l.a)(o,2),h=u[0],b=u[1],f=s-10,j=s;return Object(n.useEffect)((function(){f=s,j=s}),[s]),Object(n.useEffect)((function(){var e,a=i.current,n=a.getContext("2d"),c=[10,10],s=[a.width-c[0],a.height-c[1]];r&&(e=r[0].length,n.clearRect(0,0,n.canvas.width,n.canvas.height),t=function(e,t,a,n,r){for(var c=e/a,s=[],i=0;i<a+1;i++){for(var o=[],l=0;l<a+1;l++)i<=l&&o.push({x:(l-i)*c+i*c/2+n,y:i*c+r});s.push(o)}return s}(s[0],0,e,c[0],c[1]),b(t),function(e,t,a){for(var n=0;n<e.length-1;n++)for(var r=0;r<e[n].length-1;r++)0===n?(t.beginPath(),t.moveTo(e[n][r].x,e[n][r].y),t.lineTo(e[n][r+1].x,e[n][r+1].y),t.lineTo(e[n+1][r].x,e[n+1][r].y),t.fillStyle=a[n][r],t.fill()):(t.beginPath(),t.moveTo(e[n][r].x,e[n][r].y),t.lineTo(e[n-1][r+1].x,e[n-1][r+1].y),t.lineTo(e[n][r+1].x,e[n][r+1].y),t.lineTo(e[n+1][r].x,e[n+1][r].y),t.fillStyle=a[n][r],t.fill())}(t,n,r))}),[r,f,j]),Object(y.jsxs)("svg",{id:"wavescape".concat(a),width:f+10,height:j,xmlns:"http://www.w3.org/2000/svg",children:[Object(y.jsxs)("g",{transform:"translate(".concat(.06*f,",").concat(.1*f,")"),children:[Object(y.jsx)("circle",{cx:"5%",cy:"1%",r:"".concat(f/100*2.8,"px"),fill:"black"}),Object(y.jsx)("text",{fontSize:"".concat(f/100*5.2,"px"),textAnchor:"middle",x:"5%",y:"2.8%",fill:"white",children:a})]}),Object(y.jsxs)("g",{transform:"scale(".concat(1,", ",-ze,") translate(",0,",").concat(-j,")"),children:[Object(y.jsx)("foreignObject",{x:0,y:0,width:f,height:j,children:Object(y.jsx)("canvas",{width:f,height:j,ref:i})}),h.length>0?h[0].map((function(e,t){return Object(y.jsx)("line",{x1:e.x,x2:e.x,y1:e.y-3,y2:e.y+3,stroke:"grey",strokeWidth:"1px"},"tick".concat(t))})):null,h.length>0?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("line",{x1:h[0][0].x,x2:h[0][h[0].length-1].x,y1:h[0][0].y,y2:h[0][h[0].length-1].y,stroke:"grey",strokeWidth:"2px"}),Object(y.jsx)("line",{x1:h[0][h[0].length-1].x,x2:h[h.length-1][0].x,y1:h[0][h[0].length-1].y,y2:h[h.length-1][0].y,stroke:"grey",strokeWidth:"1px"}),Object(y.jsx)("line",{x1:h[0][0].x,x2:h[h.length-1][0].x,y1:h[0][0].y,y2:h[h.length-1][0].y,stroke:"grey",strokeWidth:"1px"}),Object(y.jsx)("circle",{cx:(h[0][c].x+h[0][c+1].x)/2,cy:(h[0][c].y+h[0][c+1].y)/2,r:.01*f,fill:"white"}),Object(y.jsx)("circle",{cx:(h[0][c].x+h[0][c+1].x)/2,cy:(h[0][c].y+h[0][c+1].y)/2,r:.01*f,stroke:"black",strokeWidth:1,fill:"transparent"})]}):null]})]})};var Ne=function(e){var t=e.wavescapesData,a=e.currentWavescapeSubdiv,n=e.elemsWidth;return Object(y.jsx)(b.a,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:t.length>0?t.map((function(e,t){return Object(y.jsx)(Be,{wsNumber:t+1,wavescapeMatrix:e,currentWavescapeSubdiv:a,wavescapeWidth:n},"w.".concat(t))})):Object(y.jsx)(j.a,{color:"error",children:"No midi file uploaded"})})},Ge=a(424),Le=null;var _e=function(e){var t,a=e.coeffNumber,r=e.protoDataCoeff,c=(e.fullTrace,e.traceDataCoeff),s=e.userPcvsCoeff,o=e.currentSubdiv,u=e.performanceCoeff,h=e.targetCircleWidth,f=e.showMagAndPhase,d=e.showFullTrace,x=Object(n.useRef)(null),p=Object(n.useState)({mu:0,phi:0}),g=Object(l.a)(p,2),O=g[0],m=g[1],v=445,w=v,k=45,C=177.5,D=.01;function A(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=180*Math.atan2(t,e)/Math.PI,r=Math.sqrt(e*e+t*t);return a&&(r/=C),n=Math.round(n+Number.EPSILON),{mu:r=Math.round(100*(r+Number.EPSILON))/100,phi:n}}function S(){var e=x.current.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.1)",c.forEach((function(t){e.beginPath(),e.arc(t.x*C,-t.y*C,2.225,0,2*Math.PI,!0),e.fill()}))}return Object(n.useEffect)((function(){if(c&&c[o]){var e=c[o].x,t=c[o].y;m(A(e,t))}}),[o,c]),Object(n.useEffect)((function(){var e=x.current,t=e.getContext("2d"),a=Math.floor(C*devicePixelRatio),n=t.createImageData(2*a,2*a),r=n.data;if(e.width=v*devicePixelRatio,e.height=w*devicePixelRatio,t.scale(devicePixelRatio,devicePixelRatio),e.style.width="445px",e.style.height="445px",!Le){for(var s=-a;s<a;s++)for(var i=-a;i<a;i++){var o=Math.sqrt(s*s+i*i);if(!(o>a)){var l=4*(s+a+(i+a)*(2*a)),u=T(s,i,o/a);r[l]=u.r,r[l+1]=u.g,r[l+2]=u.b,r[l+3]=u.a}}Le=n}t.putImageData(Le,0,0),c&&d&&(t.save(),t.translate(177.5,177.5),S(),t.restore())}),[v,w,C,c,d]),Object(n.useEffect)((function(){x.current.getContext("2d").getImageData(0,0,1,1)}),[]),Object(n.useEffect)((function(){if(c){var e=x.current.getContext("2d");e.save(),e.translate(177.5,177.5),S(),e.restore()}}),[c]),Object(y.jsx)(b.a,{sx:{marginBottom:2},children:Object(y.jsxs)("svg",{width:h,height:h,viewBox:"0 0 ".concat(v," ").concat(w),xmlns:"http://www.w3.org/2000/svg",children:[Object(y.jsxs)("g",{transform:"translate(32,8)",children:[Object(y.jsx)("circle",{cx:"12",cy:"12",r:"13",fill:"black"}),Object(y.jsx)("text",{fontSize:"24",textAnchor:"middle",x:"12",y:"20",fill:"white",children:a})]}),Object(y.jsx)("g",{transform:"translate(".concat(125,",0)"),children:f?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("text",{x:"120",y:"23",style:{fontSize:"24px"},children:"\u03c6: ".concat(O.phi,"\xb0")}),Object(y.jsx)("text",{x:"34",y:"24",style:{fontSize:"24px"},children:"\u03bc: ".concat(O.mu)})]}):null}),Object(y.jsxs)("g",{transform:"translate(0,".concat(15,")"),children:[Object(y.jsx)("foreignObject",{x:k,y:k,width:v,height:w,children:Object(y.jsx)("canvas",{id:"circle".concat(a),style:{zIndex:"-1"},width:v,height:w,ref:x})}),Object(y.jsxs)("g",{transform:"translate(".concat(222.5,",").concat(222.5,")"),children:[Object(y.jsx)("path",{fill:"azure",d:E.a().innerRadius(176.5).outerRadius(180.5).startAngle(0).endAngle(2*Math.PI)()}),r?r.map((function(e,t){return function(e,t){var a=E.a().innerRadius(4.45).outerRadius(6.675).startAngle(0).endAngle(2*Math.PI),n="",r="",c=!1;if(e.label.includes("_")||e.label.includes("^"))for(var s=0;s<e.label.length;s++)"_"===e.label[s]&&(n=e.label.slice(0,s),r=e.label.slice(s+1,e.label.length),c=!0),"^"===e.label[s]&&(n=e.label.slice(0,s),r=e.label.slice(s+1,e.label.length));else n=e.label;var i=18*Math.sign(e.x),o=18*-Math.sign(e.y)+7;return"\u266f"===n&&(o-=3),"WT"===n&&"1"===r&&(i*=1.2),"WT"===n&&"0"===r&&(i*=1.4),"C"===n&&"o7"===r&&(i*=1.2),"O"===n&&"1,2"===r&&(o*=1.1),"C\u266f"===n&&"o7"===r&&(i*=1.1,o*=1.1),"D"===n&&"o7"===r&&(i*=.7,o*=.7),"H"===n&&"2,3"===r&&(i*=1.2,o*=1.2),"H"===n&&"1,2"===r&&(i*=.7,o*=.7),"\u03a9"===n&&(i=15,o=5),Object(y.jsxs)("g",{transform:"translate(".concat(e.x*C,",").concat(-e.y*C,")"),children:[Object(y.jsx)("path",{fill:"grey",d:a()},t),Object(y.jsxs)("text",{textAnchor:"middle",dx:i,dy:o,fontSize:"20px",children:[n,c?Object(y.jsx)("tspan",{fontSize:15,baselineShift:"sub",children:r}):Object(y.jsx)("tspan",{fontSize:15,baselineShift:"super",children:r})]})]},"p.".concat(t))}(e,t)})):null,0===u.x&&0===u.y?null:(t=u,Object(y.jsxs)("g",{transform:"translate(".concat(t.x*C,",").concat(-t.y*C,")"),children:[Object(y.jsx)("line",{x1:"0",x2:"0",y1:"7",y2:"-7",stroke:"black",strokeWidth:"1.5"}),Object(y.jsx)("line",{x1:"7",x2:"-7",y1:"0",y2:"0",stroke:"black",strokeWidth:"1.5"})]})),s?s.map((function(e,t){if(!e.isDisabled)return function(e,t,a,n,r,c){var s,o=A(a,n,!0),l=40;return Object(y.jsx)(Ge.a,{placement:"top",arrow:!0,title:Object(y.jsxs)(_.a,{direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[Object(y.jsxs)("svg",{width:l,height:l,viewBox:"0 0 ".concat(l," ").concat(l),children:[Object(y.jsx)("circle",{cx:20,cy:20,r:20,strokeWidth:"1",fill:"#FFF",fillOpacity:1}),Object(y.jsx)("polyline",{transform:"translate(".concat(20,",").concat(20,") scale(",1.8,")"),fill:"none",stroke:"black",strokeWidth:"1px",points:t})]}),Object(y.jsxs)(_.a,{children:[Object(y.jsx)(j.a,{children:e}),Object(y.jsx)(j.a,{children:"\u03bc: ".concat(o.mu," \u03c6: ").concat(-o.phi,"\xb0")})]})]}),children:Object(y.jsxs)("g",{children:[Object(y.jsx)("polyline",(s={transform:"translate(".concat(a,",").concat(n,") scale(").concat(r,")"),fill:"none",stroke:"black",strokeWidth:"1px"},Object(i.a)(s,"fill","#FFF"),Object(i.a)(s,"fillOpacity",0),Object(i.a)(s,"points",t),s)),Object(y.jsx)("polyline",{transform:"translate(".concat(a,",").concat(n,") scale(").concat(r,")"),fill:"none",stroke:"black",strokeWidth:"1px",points:t})]})},"rtt.".concat(c))}(e.label,e.rosePoints,e.x*C,-e.y*C,.7,t)})):null,c?function(e){var t=E.a().innerRadius(0).outerRadius(e*v/2).startAngle(0).endAngle(2*Math.PI),a=E.a().innerRadius(e*v/2).outerRadius((e+.005)*v/2).startAngle(0).endAngle(2*Math.PI),n=[];n.push(1),n.push(.5);for(var r=2;r<7;r++)n.push(Math.round(100*(n[r-1]-.1))/100);return(o<7?c.slice(0,o+1):c.slice(o-7+1,o+1)).reverse().map((function(e,r){return Object(y.jsxs)("g",{children:[Object(y.jsx)("path",{transform:"translate(".concat(e.x*C,",").concat(-e.y*C,")"),fill:"white",fillOpacity:n[r],d:t()},r),Object(y.jsx)("path",{transform:"translate(".concat(e.x*C,",").concat(-e.y*C,")"),fill:"black",fillOpacity:n[r],d:a()},"t.".concat(r))]},"g.".concat(r))}))}(D):null]})]})]})})},Ve=[[{label:"\u03a9",x:0,y:0},{label:"C",x:1,y:0},{label:"C\u266f",x:.866,y:-.5},{label:"D",x:.5,y:-.866},{label:"E\u266d",x:0,y:-1},{label:"E",x:-.5,y:-.866},{label:"F",x:-.866,y:-.5},{label:"F\u266f",x:-1,y:0},{label:"G",x:-.866,y:.5},{label:"A\u266d",x:-.5,y:.866},{label:"A",x:0,y:1},{label:"B\u266d",x:.5,y:.866},{label:"B",x:.866,y:.5}],[{label:"\u03a9",x:0,y:0},{label:"T_0",x:1,y:0},{label:"T_1",x:.5,y:-.866},{label:"T_2",x:-.5,y:-.866},{label:"T_3",x:-1,y:0},{label:"T_4",x:-.5,y:.866},{label:"T_5",x:.5,y:.866}],[{label:"\u03a9",x:0,y:0},{label:"C+",x:1,y:0},{label:"C\u266f+",x:0,y:-1},{label:"D+",x:-1,y:0},{label:"D\u266f+",x:0,y:1},{label:"H_0,3",x:.5,y:.5},{label:"H_0,1",x:.5,y:-.5},{label:"H_1,2",x:-.5,y:-.5},{label:"H_2,3",x:-.5,y:.5}],[{label:"\u03a9",x:0,y:0},{label:"C^o7",x:1,y:0},{label:"C\u266f^o7",x:-.5,y:-.866},{label:"D^o7",x:-.5,y:.866},{label:"O_0,2",x:.25,y:.433},{label:"O_0,1",x:.25,y:-.433},{label:"O_1,2",x:-.5,y:0}],[{label:"\u03a9",x:0,y:0},{label:"C",x:1,y:0},{label:"F",x:.866,y:-.5},{label:"B\u266d",x:.5,y:-.866},{label:"E\u266d",x:0,y:-1},{label:"A\u266d",x:-.5,y:-.866},{label:"C\u266f",x:-.866,y:-.5},{label:"F\u266f",x:-1,y:0},{label:"B",x:-.866,y:.5},{label:"E",x:-.5,y:.866},{label:"A",x:0,y:1},{label:"D",x:.5,y:.866},{label:"G",x:.866,y:.5},{label:"\u266e",x:.267,y:.462},{label:"5\u266d",x:0,y:-.533},{label:"2\u266f",x:-.267,y:.462},{label:"3\u266d",x:.462,y:-.267},{label:"4\u266f",x:-.533,y:0},{label:"\u266d",x:.462,y:.267},{label:"6\u266f",x:-.267,y:-.462},{label:"\u266f",x:0,y:.533},{label:"4\u266d",x:.267,y:-.462},{label:"3\u266f",x:-.462,y:.267},{label:"2\u266d",x:.533,y:0},{label:"5\u266f",x:-.462,y:-.267}],[{label:"\u03a9",x:0,y:0},{label:"WT_0",x:1,y:0},{label:"WT_1",x:-1,y:0}]];var He=function(e){var t=e.fullTraces,a=e.coeffTracesData,r=e.showPrototypes,c=e.showMagAndPhase,s=e.userPcvs,i=e.currentSubdiv,o=e.midiDevNotesDftCoeffs,u=e.elemsWidth,h=e.showFullTrace,f=Object(n.useState)(Ve),j=Object(l.a)(f,2),d=j[0],x=j[1],p=Object(n.useState)([]),g=Object(l.a)(p,2),O=g[0],m=g[1];return Object(n.useEffect)((function(){x(r?Ve:[])}),[r]),Object(n.useEffect)((function(){for(var e=[],t=1;t<7;t++){for(var a=[],n=0;n<s.length;n++)a.push({x:s[n].coeffs[t].re,y:s[n].coeffs[t].im,rosePoints:s[n].rosePoints,isDisabled:s[n].isDisabled,label:s[n].label});e.push(a)}m(e)}),[s]),Object(y.jsx)(b.a,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:[1,2,3,4,5,6].map((function(e){return Object(y.jsx)(_e,{coeffNumber:e,protoDataCoeff:d[e-1],fullTrace:t[e-1],traceDataCoeff:a[e-1],userPcvsCoeff:O[e-1],currentSubdiv:i,performanceCoeff:o[e],targetCircleWidth:u,showMagAndPhase:c,showFullTrace:h},"w.".concat(e))}))})},qe=a(373),Ue=a(444),Je=a(432),Ke=a(433),Qe=a(425),Xe=a(430),Ye=a(449),Ze=a(450),$e=a(140),et=a.n($e),tt=Object(g.a)(h.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,a=e.open;return Object(u.a)({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},a&&{width:"calc(100% - ".concat(400,"px)"),marginLeft:"".concat(400,"px"),transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})}));var at,nt,rt=function(e){var t=e.fileName,a=e.setInAnalysisPage,r=e.open,c=e.setOpen,s=e.wavescapesData,i=e.fullTraces,o=e.coeffTracesData,u=e.currentSubdiv,h=e.currentWavescapeSubdiv,d=e.userPcvs,x=Object(n.useState)(!0),p=Object(l.a)(x,2),g=p[0],O=p[1],m=Object(n.useState)(!0),v=Object(l.a)(m,2),w=v[0],k=v[1],C=Object(n.useState)(!0),D=Object(l.a)(C,2),A=D[0],S=D[1],P=Object(n.useState)(se([0,0,0,0,0,0,0,0,0,0,0,0]).map((function(e){return{x:e.re,y:e.im}}))),F=Object(l.a)(P,2),E=F[0],W=F[1],M=Object(n.useRef)(null),I=Object(n.useState)(100),T=Object(l.a)(I,2),R=T[0],z=T[1],B=Object(n.useState)(6),N=Object(l.a)(B,2),G=N[0],_=N[1],V=Object(n.useState)(440),H=Object(l.a)(V,2),q=H[0],U=H[1];function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=20;M.current&&U((M.current.clientWidth+e)/G-t)}function K(){J(0)}return Object(n.useEffect)((function(){a(!0),c(!0),J(),window.addEventListener("resize",K)}),[]),Object(n.useEffect)((function(){S(!0)}),[o]),Object(n.useEffect)((function(){J(),window.addEventListener("resize",K)}),[G]),Object(n.useEffect)((function(){J(r?-400:400)}),[r]),Object(n.useEffect)((function(){J()}),[R]),Object(n.useEffect)((function(){var e=[],t=new L.c({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/"}).toDestination();function a(a){var n=a.data[0];if(144===n||128===n){var r=L.a(a.data[1],"midi").toNote();if(128!==n||e.includes(r)){var c=Math.round(.05*a.data[2]);switch(n){case 144:c>0?(t.triggerAttack(r,L.f(),c),e.push(r)):(t.triggerRelease(r,L.f()),e=e.filter((function(e){return e!==r})));break;case 128:t.triggerRelease(r,L.f()),e=e.filter((function(e){return e!==r}))}!function(e){var t=[0,0,0,0,0,0,0,0,0,0,0,0];e.forEach((function(e){switch(e.includes("#")?e.slice(0,2):e.slice(0,1)){case"C":t[0]+=1;break;case"C#":t[1]+=1;break;case"D":t[2]+=1;break;case"D#":t[3]+=1;break;case"E":t[4]+=1;break;case"F":t[5]+=1;break;case"F#":t[6]+=1;break;case"G":t[7]+=1;break;case"G#":t[8]+=1;break;case"A":t[9]+=1;break;case"A#":t[10]+=1;break;case"B":t[11]+=1}}));var a=se(t);a=a.map((function(e){return{x:e.re,y:e.im}})),W(a)}(e)}}}function n(e){console.log("Name: ".concat(e.port.name,", Brand: ").concat(e.port.manufacturer,", State: ").concat(e.port.state,", Type: ").concat(e.port.type))}t.volume.value=-30,navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then((function(e){e.onstatechange=n,e.inputs.forEach((function(e){e.onmidimessage=a}))}),(function(){console.log("Could not connect MIDI")}))}),[]),Object(y.jsxs)(b.a,{children:[Object(y.jsxs)(b.a,{sx:{padding:0,margin:"auto",marginBottom:"70px",width:"".concat(R,"%")},children:[Object(y.jsxs)(Xe.a,{defaultExpanded:!0,children:[Object(y.jsx)(Ye.a,{expandIcon:Object(y.jsx)(et.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(y.jsx)(j.a,{variant:"h6",children:"Wavescapes"})}),Object(y.jsx)(Ze.a,{ref:M,sx:{padding:0},children:Object(y.jsx)(Ne,{wavescapesData:s,currentWavescapeSubdiv:h,elemsWidth:q})})]}),Object(y.jsxs)(Xe.a,{defaultExpanded:!0,children:[Object(y.jsx)(Ye.a,{expandIcon:Object(y.jsx)(et.a,{}),"aria-controls":"panel2a-content",id:"panel2a-header",children:Object(y.jsx)(j.a,{variant:"h6",children:"Fourier Coefficient Spaces"})}),Object(y.jsx)(Ze.a,{sx:{padding:0},children:Object(y.jsx)(He,{fullTraces:i,coeffTracesData:o,currentSubdiv:u,showPrototypes:g,showMagAndPhase:w,showFullTrace:A,userPcvs:d,midiDevNotesDftCoeffs:E,elemsWidth:q})})]})]}),Object(y.jsx)(tt,{position:"fixed",open:r,color:"secondary",sx:{top:"auto",bottom:0,maxHeight:"74px"},children:Object(y.jsxs)(f.a,{children:[Object(y.jsx)(te,{fileName:t,currentWavescapeSubdiv:h}),Object(y.jsx)(b.a,{sx:{display:"flex",alignItems:"center",margin:"2% 5%",maxWidth:"100px",justifyContent:"space-evenly"},children:Object(y.jsxs)(qe.a,{children:[Object(y.jsx)(de.a,{control:Object(y.jsx)(Ue.a,{onChange:function(){S(!A)},checked:A,size:"small"}),label:Object(y.jsx)(j.a,{noWrap:!0,children:"Show full trace"})}),Object(y.jsx)(de.a,{control:Object(y.jsx)(Ue.a,{onChange:function(){O(!g)},checked:g,size:"small"}),label:Object(y.jsx)(j.a,{noWrap:!0,children:"Show Prototypes"})}),Object(y.jsx)(de.a,{control:Object(y.jsx)(Ue.a,{onChange:function(){k(!w)},checked:w,size:"small"}),label:Object(y.jsx)(j.a,{noWrap:!0,children:"Show \u03bc and \u03c6"})})]})}),Object(y.jsxs)(b.a,{sx:{minWidth:"20%",padding:"1% 3% 1% 2%",marginTop:1},children:[Object(y.jsx)(j.a,{children:"Plots size"}),Object(y.jsx)(Q.a,{min:20,max:100,value:R,defaultValue:100,"aria-label":"Plots size",valueLabelDisplay:"auto",onChange:function(e,t){z(t)},marks:[{value:20,label:"20%"},{value:50,label:"50%"},{value:100,label:"100%"}]})]}),Object(y.jsx)(b.a,{sx:{minWidth:120},children:Object(y.jsxs)(je.a,{size:"small",variant:"standard",fullWidth:!0,children:[Object(y.jsx)(Je.a,{children:"Layout"}),Object(y.jsxs)(Qe.a,{value:G,label:"Layout",onChange:function(e){z(100),_(e.target.value)},children:[Object(y.jsx)(Ke.a,{value:6,children:"1x6"}),Object(y.jsx)(Ke.a,{value:3,children:"2x3"}),Object(y.jsx)(Ke.a,{value:2,children:"3x2"}),Object(y.jsx)(Ke.a,{value:1,children:"6x1"})]})]})})]})})]})},ct=a(29),st=a(435),it=a(179),ot=a.n(it),lt=a(422),ut=80,ht=Object(g.a)("main",{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,a=e.open;return Object(u.a)({flexGrow:1,padding:t.spacing(3),backgroundColor:"#e0e0e0",transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:"-".concat(400,"px")},a&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0,backgroundColor:"#e0e0e0"})})),bt=Object(g.a)("div")((function(e){var t=e.theme;return Object(u.a)(Object(u.a)({display:"flex",alignItems:"center",padding:t.spacing(0,1)},t.mixins.toolbar),{},{justifyContent:"space-between"})}));var ft=function(){var e,t=Object(ct.a)(),a=Object(n.useState)(!1),r=Object(l.a)(a,2),c=r[0],s=r[1],u=Object(n.useState)(""),h=Object(l.a)(u,2),f=h[0],x=h[1],g=Object(n.useState)([]),O=Object(l.a)(g,2),w=O[0],D=O[1],P=Object(n.useState)([]),E=Object(l.a)(P,2),W=E[0],M=E[1],I=Object(n.useState)([]),T=Object(l.a)(I,2),z=T[0],B=T[1],L=Object(n.useState)(0),V=Object(l.a)(L,2),H=V[0],q=V[1],U=Object(n.useState)(1),J=Object(l.a)(U,2),K=J[0],X=J[1],Y=Object(n.useState)(!1),Z=Object(l.a)(Y,2),ee=Z[0],te=Z[1],ae=Object(n.useState)("1"),ne=Object(l.a)(ae,2),re=ne[0],be=ne[1],fe=Object(n.useState)({noteResolutionValue:1,seconds:1.5,useSeconds:!1}),je=Object(l.a)(fe,2),de=je[0],pe=je[1],ge=Object(n.useState)(10),Oe=Object(l.a)(ge,2),me=Oe[0],ve=Oe[1],we=Object(n.useState)(1),Ce=Object(l.a)(we,2),Ae=Ce[0],Se=Ce[1],Pe=Object(n.useState)([]),Fe=Object(l.a)(Pe,2),Ee=Fe[0],We=Fe[1],Me=Object(n.useRef)(null),Te=Object(n.useState)(!1),ze=Object(l.a)(Te,2),Be=ze[0],Ne=ze[1],Ge=Object(n.useState)(!1),Le=Object(l.a)(Ge,2),_e=Le[0],Ve=Le[1],He=Object(n.useState)([]),qe=Object(l.a)(He,2),Ue=qe[0],Je=qe[1];function Ke(e){var t,a=[];try{t=function(e){for(var t=[],a=!1,n=!1,r=0;r<e.length;r++)if("{"!==e[r]&&"("!==e[r]||(a=!0,"{"===e[r]&&(n=!0)),a){for(var c=[],s=r+1;"}"!==e[s]&&")"!==e[s];s++){if(","!==e[s]&&"."!==e[s]&&" "!==e[s]&&isNaN(parseFloat(e[s])))throw new Error("Found NaN");" "!==e[s]&&c.push(e[s])}if(""===(c=c.join("")))throw new Error("Empty input");for(var i=[],o=0,l=0;l<c.length;l++){if(","===c[l]){var u=c.slice(l-o,l);if(0===u.length)throw new Error("Two consecutive comas");i.push(+u),o=-1}o++}var h=c.slice(c.length-o,c.length);if(0===h.length)throw new Error("Missing last number");if(i.push(+h),n){for(var b=[0,0,0,0,0,0,0,0,0,0,0,0],f=0;f<i.length;f++){if(i[f]<0||i[f]>=12)throw new Error("Set notation: out of range");b[i[f]]+=1}t.push(b)}else{if(12!==i.length)throw new Error("Vectorial notation: missing elements");t.push(i)}a=!1,n=!1,r+=o}if(0===t.length)throw new Error("Invalid input");return t}(e)}catch(n){return console.log(n.message),void Ne(!0)}t.forEach((function(e){return a.push({label:"(".concat(e,")"),isDisabled:!1,coeffs:se(e,!0,!0,!1),rosePoints:[],n:-1,d:-1})})),Ee.map((function(e){return e.label})).forEach((function(e){a=a.filter((function(t){return t.label!==e}))})),a.forEach((function(e){for(var t=!1,a=0;a<Ue.length&&!t;a++)for(var n=0;n<Ue[a].length&&!t;n++)Ue[a][n].usable&&!Ue[a][n].used&&(t=!0,e.rosePoints=Ue[a][n].points,Ue[a][n].used=!0,e.n=Ue[a][n].n,e.d=Ue[a][n].d)})),We([].concat(Object(o.a)(Ee),Object(o.a)(a)))}return Object(n.useEffect)((function(){var e=[];1===K?B(W):(W.forEach((function(t){for(var a=[],n=0;n<=t.length-K;n++){for(var r={x:0,y:0},c=0;c<K;c++)r.x+=t[n+c].x,r.y+=t[n+c].y;a.push(r)}a.forEach((function(e){e.x=e.x/K,e.y=e.y/K})),e.push(a)})),console.log(e),B(e))}),[K,W]),Object(n.useEffect)((function(){var e=document.getElementById("file").files[0];if(nt=e?e.name:"",e){var t=new FileReader;t.readAsArrayBuffer(e),t.onload=function(e){var t=function(e){var t=new ce.Midi(e),a=t.header.tempos.map((function(e){return Math.round(e.bpm)})),n=Math.max.apply(Math,Object(o.a)(a)),r=t.tracks.filter((function(e){return!1===e.instrument.percussion}));return t.tracks=r,{midiData:t,midiBpm:n}}(e.target.result),a=t.midiData,n=t.midiBpm;ut=n;var r=(at=a).duration/50;ve(r),D(function(e){for(var t=e[0].length,a=e[0].length,n=2,r=1;r<t;r++){for(var c=[],s=0;s+n<=a;s++){var i=e[0].slice(s,s+n);c.push(ie(i))}n++,e.push(c)}for(var o=[],l=0;l<6;l++){for(var u=[],h=0;h<e.length;h++){for(var b=[],f=0;f<e[h].length;f++)b.push("");u.push(b)}o.push(u)}for(var j=0;j<e.length;j++)for(var d=0;d<e[j].length;d++)for(var x=1;x<e[j][d].length;x++)o[x-1][j][d]=R(e[j][d][x]);return o}(function(e,t){var a=[];e.tracks.forEach((function(n){return a.push(ue(n.notes,t,e.duration))}));for(var n=[],r=0;r<a[0].length;r++)n.push(new oe);for(var c=0;c<a.length;c++)for(var s=0;s<a[c].length;s++)for(var i=0;i<a[c][s].length;i++){var o=a[c][s][i],l=o.pitch,u=o.duration;n[s].addNoteDuration(l,u)}var h=n.map((function(e){return se(e.getPcvAsArray())})),b=[];return b.push(h),b}(at,r)));var c=le(a,de,ut),s=c.tracesData,i=c.resolution;Se(i),M(s),$(at,i,q),console.log(a)}}}),[f]),Object(n.useEffect)((function(){for(var e=[],t=1;t<=7;t++){for(var a=[],n=1;n<=7;n++){var r={n:n,d:t,used:!1,usable:!0,points:[]};n%t===0&&1!==t&&(r.usable=!1),!0===r.usable&&(r.points=he(n,t)),a.push(r)}e.push(a)}e[0][0].usable=!1,Je(e);var c=[[1,0,0,0,1,0,0,1,0,0,0,0],[1,0,0,1,0,0,0,1,0,0,0,0],[1,0,0,1,0,0,1,0,0,0,0,0]].map((function(e){return{label:"(".concat(e.toString(),")"),isDisabled:!1,coeffs:se(e,!0,!0,!1),rosePoints:[],n:-1,d:-1}}));c.forEach((function(t){for(var a=!1,n=0;n<e.length&&!a;n++)for(var r=0;r<e[n].length&&!a;r++)e[n][r].usable&&!e[n][r].used&&(a=!0,t.rosePoints=e[n][r].points,e[n][r].used=!0,t.n=e[n][r].n,t.d=e[n][r].d)})),c[1].isDisabled=!0,c[2].isDisabled=!0,We(c)}),[]),Object(y.jsxs)(p.a,{children:[Object(y.jsx)(S.a,{}),Object(y.jsx)(k,{open:c,setOpen:s,setInAnalysisPage:Ve,inAnalysisPage:_e}),Object(y.jsxs)(b.a,{sx:{display:"flex"},children:[Object(y.jsxs)(st.a,{sx:{width:400,flexShrink:0,"& .MuiDrawer-paper":{width:400,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:c,children:[Object(y.jsxs)(bt,{children:[Object(y.jsxs)(_.a,{sx:{flexGrow:"2",maxWidth:"85%",marginBottom:1},children:[Object(y.jsx)(j.a,{sx:{fontWeight:"bold"},children:"Upload a midi file"}),Object(y.jsxs)(_.a,{spacing:2,direction:"row",sx:{alignItems:"center"},children:[Object(y.jsxs)("label",{htmlFor:"file",children:[Object(y.jsx)("input",{style:{display:"none"},type:"file",id:"file",name:"file",value:f,onChange:function(e){return x(e.target.value)}}),Object(y.jsx)(d.a,{variant:"contained",size:"small",color:"primary",component:"span",children:"Upload"})]}),Object(y.jsx)(j.a,{noWrap:!0,color:nt?"primary":"error",children:f?nt:"No midi file uploaded"})]})]}),Object(y.jsx)(v.a,{onClick:function(){s(!1)},children:"ltr"===t.direction?Object(y.jsx)(ot.a,{}):Object(y.jsx)(m.a,{})})]}),Object(y.jsx)(lt.a,{}),Object(y.jsx)(j.a,{sx:{marginLeft:1,marginTop:1,fontWeight:"bold"},children:"Time resolution"}),Object(y.jsx)(b.a,{sx:{display:"flex",alignItems:"center",margin:"2% 5% 0 2%",width:"90%",justifyContent:"space-evenly"},children:Object(y.jsx)(ye,{setResolutionMode:pe,resolutionMode:de,retriggerAnalysis:function(){if(null!=at){var e=le(at,de,ut),t=e.tracesData,a=e.resolution;Se(a),M(t),$(at,a,q)}}})}),Object(y.jsx)(lt.a,{}),Object(y.jsx)(j.a,{sx:{marginLeft:1,marginTop:1,fontWeight:"bold"},children:"Window Length"}),Object(y.jsxs)(_.a,{sx:{margin:"auto",marginBottom:1,marginTop:1},direction:"row",children:[Object(y.jsx)(j.a,{sx:{marginLeft:1,paddingTop:"5px",marginRight:"5px",fontSize:"18px"},variant:"h5",gutterBottom:!0,children:"\xd7 "}),Object(y.jsx)(xe.a,{inputProps:{style:{textAlign:"center"}},sx:{width:"15%"},error:ee,onChange:function(e){be(e.target.value);var t=parseInt(e.target.value);isNaN(t)?te(!0):(te(!1),W.length>0?t<1?(te(!0),X(1)):t>W[0].length?(te(!0),X(W[0].length)):X(t):X(t))},value:re,variant:"standard"}),Object(y.jsx)(j.a,{sx:{marginLeft:1,paddingTop:"5px",fontSize:"18px"},variant:"h5",gutterBottom:!0,children:"time resolution"})]}),Object(y.jsx)(Q.a,{sx:{margin:"auto",width:"80%",marginBottom:3},value:K,onChange:function(e,t){X(t),be(t)},"aria-label":"Window Length",defaultValue:1,valueLabelDisplay:"auto",min:1,max:W.length>0?W[0].length:100,marks:W.length>0?[{value:1,label:"1"},{value:W[0].length,label:"".concat(W[0].length)}]:[{value:1,label:"1"},{value:100,label:"100"}]}),Object(y.jsx)(lt.a,{}),Object(y.jsx)(j.a,{sx:{marginLeft:1,marginTop:1,fontWeight:"bold"},children:"Custom pitch-class vectors"}),Object(y.jsxs)(b.a,{sx:{flexDirection:"column",display:"flex",alignItems:"center",margin:"3% 5%",height:"40%",maxHeight:"350px",justifyContent:"flex-start"},component:"form",noValidate:!0,autoComplete:"off",children:[Object(y.jsx)(xe.a,(e={fullWidth:!0,label:'margin="dense"',error:Be,helperText:Be&&"Invalid input",id:"outlined-basic"},Object(i.a)(e,"label","e.g. {0,0,4,7,10} (2,0,0,0,1,0,0,1,0,0,1,0)"),Object(i.a)(e,"variant","outlined"),Object(i.a)(e,"onKeyPress",(function(e){"Enter"===e.key&&(e.preventDefault(),Ke(Me.current.value),Me.current.value="")})),Object(i.a)(e,"onChange",(function(){Ne(!1)})),Object(i.a)(e,"inputRef",Me),e)),Object(y.jsx)(De,{userPcvs:Ee,setUserPcvs:We,rosesMat:Ue})]}),Object(y.jsx)(lt.a,{}),Object(y.jsx)(j.a,{sx:{marginLeft:1,marginTop:1,fontWeight:"bold"},children:"Legend of coefficients"}),Object(y.jsx)(b.a,{sx:{margin:"5px 10px"},children:Object(y.jsx)(ke.a,{children:Object(y.jsxs)(_.a,{children:[Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(y.jsx)("circle",{cx:"12",cy:"12",r:"8",fill:"black"}),Object(y.jsx)("text",{fontSize:"15",textAnchor:"middle",x:"12",y:"17",fill:"white",children:"k"})]}),"Fourier coefficient number"]}),Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(y.jsx)("circle",{cx:"12",cy:"12",r:"6",fill:"black"})}),"MIDI file segments"]}),Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(y.jsx)("circle",{cx:"12",cy:"12",r:"5",fill:"white"}),Object(y.jsx)("circle",{cx:"12",cy:"12",r:"5",fill:"none",stroke:"black",strokeWidth:"3px"})]}),"MIDI playback"]}),Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(y.jsxs)("g",{transform:"translate(12,12)",children:[Object(y.jsx)("line",{x1:"0",x2:"0",y1:"7",y2:"-7",stroke:"black",strokeWidth:"1.5"}),Object(y.jsx)("line",{x1:"7",x2:"-7",y1:"0",y2:"0",stroke:"black",strokeWidth:"1.5"})]})}),"MIDI controller input"]}),Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Object(y.jsx)("circle",{cx:"12",cy:"12",r:"7",fill:"none",stroke:"grey",strokeWidth:"2px"})}),"Prototypes"]}),Object(y.jsxs)(_.a,{direction:"row",children:[Object(y.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Ue.length>0?Object(y.jsx)("polyline",{transform:"translate(".concat(12,",",12,")"),fill:"none",stroke:"black",strokeWidth:"1px",points:Ue[3][0].points}):null}),"Custom pitch-class vectors"]})]})})}),Object(y.jsx)(d.a,{variant:"contained",size:"small",color:"primary",sx:{width:"35%",margin:"auto",marginTop:1,marginBottom:1},onClick:function(){var e=new F.a,t="<svg xmlns='http://www.w3.org/2000/svg' width='".concat(20,"' height='",20,"'>\n                          <circle cx='12' cy='12' r='12' fill='black' />\n                        </svg>");[1,2,3,4,5,6].forEach((function(a){var n=function(e){var t=Object(y.jsx)(N,{traceData:W,printablePitchClasses:[],userPcv:[],coeffNumber:e});return A.a.renderToStaticMarkup(t)}(a);e.file("wavescapes/wavescape".concat(a,".svg"),t),e.file("fourier/space".concat(a,".svg"),n)})),e.generateAsync({type:"blob"}).then((function(e){Object(G.saveAs)(e,"images.zip")}))},children:"Export images"})]}),Object(y.jsx)(ht,{open:c,children:Object(y.jsxs)(C.c,{children:[Object(y.jsx)(C.a,{exact:!0,path:"/",render:function(){return Object(y.jsx)(Ie,{setOpen:s,setInAnalysisPage:Ve})}}),Object(y.jsx)(C.a,{exact:!0,path:"/theory",render:function(){return Object(y.jsx)(Re,{setOpen:s,setInAnalysisPage:Ve})}}),Object(y.jsx)(C.a,{exact:!0,path:"/analysis",render:function(){return Object(y.jsx)(rt,{fileName:nt,setInAnalysisPage:Ve,open:c,setOpen:s,wavescapesData:w,fullTraces:W,coeffTracesData:z,currentSubdiv:z.length>0&&H>=z[0].length?z[0].length-1:H,currentWavescapeSubdiv:Math.floor(H*Ae/me),userPcvs:Ee})}})]})})]})]})},jt=a(180),dt=a(434),xt=Object(jt.a)({palette:{primary:{main:"#323232"},secondary:{main:"#fefefe"},background:{default:"#e0e0e0"}}});s.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(dt.a,{theme:xt,children:Object(y.jsx)(ft,{})})}),document.getElementById("root"))}},[[359,1,2]]]);
//# sourceMappingURL=main.f735f053.chunk.js.map